# task03_feature_implementation.prompt.md

## 目的

M5Stack集中タイマーの「未実装機能・詳細ロジックの実装」フェーズに着手する。主に以下の内容を段階的に実装・検証する。

## 実装計画

1. **メイン表示画面の詳細作り込み**
   - 残り時間の正確な計算・表示（-HH:MM:SS）
   - 進捗バーの進捗率計算と描画（直前の解除時刻～次アラーム時刻）
   - 鳴動時刻リストのスクロール表示
   - NEXT時刻の表示

2. **入力モードのロジック実装**
   - 数字入力UI（カーソル移動、ネガポジ反転、未入力は_表示）
   - 入力値のバリデーション、確定/キャンセル処理
   - 入力値からアラーム時刻を計算しリストに追加

3. **スケジュール選択モードの作り込み**
   - リスト項目の選択・削除
   - [SETTINGS]項目の選択・遷移
   - 選択中項目のネガポジ反転表示

4. **アラーム鳴動状態の詳細**
   - フラッシュオレンジ点滅、オーバータイム表示
   - バイブレーション・音の間欠制御
   - 解除ロジック

5. **SETTINGSサブメニューの作り込み**
   - 各設定項目の選択・変更・永続化
   - ALL CLEARの二重確認
   - INFO画面遷移

6. **エラーハンドリング・UI改善**
   - Wi-Fi/NTP失敗時の表示
   - 入力エラー時の警告表示
   - その他UI/UX細部調整

7. **Unit Testの追加**
   - 時刻計算、設定管理、入力処理のテスト

## 実行手順

- 上記1から順に、1つずつ実装・ビルド・実機確認を行う。
- 各ステップで「どのファイルをどう編集するか」を明示し、進捗を記録する。
- 必要に応じてユーザーにビルド・実機確認を依頼し、次工程へ進む。

---

次は「1. メイン表示画面の詳細作り込み」から着手する。
- `ui.cpp`/`ui.h` にメイン画面描画の詳細ロジックを実装。
- `alarm.cpp`/`alarm.h` にアラーム時刻の管理・計算ロジックを実装。
- `main.cpp` でこれらを呼び出す。

この内容で進めます。
