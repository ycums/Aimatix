# 設定画面（SettingsDisplay）実装仕様確認質問票

## 概要
設定画面（SettingsDisplay）の実装に取り掛かる前に、仕様の不明点を確認するための質問票です。
各項目について、チェックボックスまたは自由記述で回答してください。

---

## 1. 設定画面の基本仕様

### 1-1 画面遷移
- [x] Q1-1: 設定画面への遷移方法は以下で正しいですか？
  - メイン画面でC長押しで設定画面に遷移
    - 長押しの判定基準は他と共通
  - 設定画面からC長押しでメイン画面に戻る

- [x] **Q1-2**: 設定画面の初期状態は「項目選択モード」で正しいですか？

### 1-2 表示内容
- [x] **Q1-3**: 設定画面のタイトルは「SETTINGS」で正しいですか？

- [x] **Q1-4**: 設定項目の表示順序は以下で正しいですか？
  1. Sound（音ON/OFF）
  2. LCD Brightness（明度調整）
  3. Set Date/Time（日時設定）
  4. Info（情報表示）
  - 不要
    - WARNING COLOR TEST
    - All Clear（全削除）

---

## 2. ボタン操作仕様

### 2-1 項目選択モード
- [x] **Q2-1**: 項目選択モードでのボタン操作は以下で正しいですか？
  - A: 前項目（上に移動）
  - B: 次項目（下に移動）
  - C: 選択確定（値変更モードに入る）
  - C長押し: メイン画面に戻る

- [x] **Q2-2**: ボタンヒントは以下で正しいですか？
  - A: "UP" B: "DOWN" C: "SELECT"

### 2-2 値変更モード
- [x] **Q2-3**: 値変更モードでのボタン操作は以下で正しいですか？
  - A: 値減少/切り替え
  - B: 値増加/切り替え
  - C: 確定（設定メニューに戻る）
  - C長押し: 項目選択モードに戻る

- [x] **Q2-4**: 値変更モードのボタンヒントは以下で正しいですか？
  - A: "DEC" B: "INC" C: "OK"

---

## 3. 設定項目の詳細仕様

### 3-1 Sound設定
- [x] **Q3-1**: Sound設定の値はON/OFFの2値で正しいですか？

- [x] **Q3-2**: Sound設定の初期値はONで正しいですか？

- [x] **Q3-3**: Sound設定の表示形式は「SOUND: ON」または「SOUND: OFF」で正しいですか？

### 3-2 LCD Brightness設定
- [x] **Q3-4**: LCD Brightnessの値範囲は50-250で正しいですか？

- [x] **Q3-5**: LCD Brightnessの刻み値は50で正しいですか？

- [x] **Q3-6**: LCD Brightnessの初期値は何ですか？
  - [x] 100
  - [ ] 150
  - [ ] 200
  - [ ] その他: _________

- [x] **Q3-7**: LCD Brightnessの表示形式は「LCD BRIGHTNESS: 150」で正しいですか？

### 3-3 WARNING COLOR TEST
この機能は不要。
- [ ] **Q3-8**: WARNING COLOR TESTは設定値ではなく、実行機能（テスト実行）で正しいですか？
- [ ] **Q3-9**: WARNING COLOR TEST実行時は、画面がフラッシュオレンジで点滅する仕様で正しいですか？

### 3-4 All Clear
この機能は不要
- [ ] Q3-10: All Clearは設定値ではなく、実行機能（アラーム全削除）で正しいですか？
- [ ] **Q3-11**: All Clear実行時は確認ダイアログを表示する仕様で正しいですか？

### 3-5 Set Date/Time設定
- [x] **Q3-12**: Set Date/Timeは設定値ではなく、日時入力画面への遷移機能で正しいですか？

- [x] **Q3-13**: 日時入力画面の入力形式は「YYYY/MM/DD HH:MM」で正しいですか？

- [x] **Q3-14**: 日時入力画面の入力方法は桁ごと編集（時刻入力と同様）で正しいですか？

- [x] **Q3-15**: 日時入力画面のカーソル位置は以下で正しいですか？
  - 0=年千, 1=年百, 2=年十, 3=年一, 4=月十, 5=月一, 6=日十, 7=日一, 8=時十, 9=時一, 10=分十, 11=分一

- [x] **Q3-16**: 日時入力画面のバリデーション範囲は以下で正しいですか？
  - 年: 2020-2030
  - 月: 01-12
  - 日: 01-31（月に応じて調整）
  - 時: 00-23
  - 分: 00-59

- [x] **Q3-17**: 日時入力画面のタイトルは「SET DATE/TIME」で正しいですか？

- [x] **Q3-18**: 日時入力画面のボタン操作は以下で正しいですか？
  - A: +1（短押し）
  - B: カーソルを右へ（短押し）(循環)
  - C: 確定（短押し）/ 戻る（長押し）

- [x] **Q3-19**: 日時入力画面のボタンヒントは「A: "INC" B: "NEXT" C: "SET"」で正しいですか？

- [x] **Q3-20**: 日時入力画面で確定時にシステム時刻が更新される仕様で正しいですか？

- [x] **Q3-21**: 日時設定は EEPROM で永続化。起動時に読み込み。

### 3-6 Info
- [x] **Q3-22**: Infoは設定値ではなく、情報表示画面への遷移機能で正しいですか？
- [x] **Q3-23**: Info画面では以下を表示する仕様で正しいですか？
  - アプリ名、バージョン
  - MACアドレス

---

## 4. 設定の永続化

### 4-1 保存タイミング
- [x] **Q4-1**: 設定値の保存タイミングは以下で正しいですか？
  - 値変更モードでCボタン（確定）を押した時点で保存
  - 値変更モードでC長押し (項目選択モードに戻る) のときは保存しない (キャンセル)


### 4-2 保存対象
- [x] **Q4-2**: 永続化する設定項目は以下で正しいですか？
  - Sound設定（ON/OFF）
  - LCD Brightness設定（50-250）
  - Set Date/Time

- [x] **Q4-3**: 永続化しない設定項目は以下で正しいですか？
  - Info（表示機能のため）

### 4-3 初期値
- [x] **Q4-4**: 初回起動時や設定ファイルが存在しない場合の初期値は以下で正しいですか？
  - Sound: ON
  - LCD Brightness: 150
  - Set Date/Time: 2025/01/01 00:00

---

## 5. UI表示仕様

画面レイアウトや基本的なUXは アラーム管理画面 と同一。
ソースコード上もなるべく共通化させる。

### 5-1 選択表示
- [x] **Q5-1**: 選択中の項目は背景色反転（アンバー⇔黒）で表示する仕様で正しいですか？

### 5-2 フォント・色
- [x] **Q5-2**: 設定項目の表示フォントはFont4で正しいですか？
- [x] **Q5-3**: 設定項目の表示色はアンバー色（#FB20）で正しいですか？

### 5-4 レイアウト
- [x] **Q5-4**: 設定項目の表示位置は以下で正しいですか？
  - グリッドセル(0,2)-(15,6)の範囲内
  - 1行に1項目ずつ表示

---

## 6. エラー処理

### 6-1 無効な値
- [x] **Q6-1**: LCD Brightnessで無効な値（50未満、250超過）が設定された場合の処理は以下で正しいですか？
  - 値変更を拒否し、現在の値を維持
  - エラーメッセージは表示しない
  - 画面を blink

### 6-2 保存エラー
- [x] **Q6-2**: 設定保存時にエラーが発生した場合の処理は以下で正しいですか？
  - エラーメッセージを一時表示
  - 設定画面は維持（メイン画面に戻らない）

---

## 7. 実装方針

### 7-1 状態管理
- [x] **Q7-1**: 設定画面の状態管理は以下で正しいですか？
  - 項目選択モードと値変更モードの2つの状態
  - 現在選択中の項目インデックス
  - 値変更モード時の一時的な値

### 7-2 ロジック分離
- [x] **Q7-2**: SettingsLogicの責務は以下で正しいですか？
  - 設定値のロード・保存・リセット・バリデーション
  - UI遷移や画面制御は一切行わない
  - EEPROM等の副作用はインターフェース経由でのみ行う

### 7-3 画面遷移
- [x] **Q7-3**: 設定画面の画面遷移は以下で正しいですか？
  - StateManager経由で状態遷移を管理
  - SettingsDisplayStateとしてIStateを実装
  - ボタン操作イベントをStateManager経由で処理

---

## 8. その他の確認事項

### 8-1 自由記述
**Q8-1**: 上記以外で確認が必要な仕様や、不明な点があれば記入してください。

```
_________________________________________________________________
_________________________________________________________________
_________________________________________________________________
```

### 8-2 優先度
**Q8-2**: 3-0-12フェーズで実装すべき最低限の機能は何ですか？（複数選択可）
- [x] 設定画面への遷移
- [x] 項目選択モード（上下移動）
- [ ] 値変更モード（Sound設定）
- [ ] 値変更モード（LCD Brightness設定）
- [ ] 設定の永続化
- [ ] WARNING COLOR TEST機能
- [ ] All Clear機能
- [x] Set Date/Time画面遷移
- [x] Info画面遷移
- [x] メイン画面への遷移

---

**作成日**: 2025年1月
**作成者**: AI Assistant
**目的**: 設定画面（SettingsDisplay）実装前の仕様確認 