---
alwaysApply: true
---
# Line Endings Policy (LF only)

このリポジトリでは、改行コードは常に LF を使用します（CRLF 禁止）。

- 必須設定
  - すべてのテキストファイルは LF。最終行に改行を入れる。
  - `.gitattributes` と `.editorconfig` を厳守。
    - [.gitattributes](mdc:.gitattributes)
    - [.editorconfig](mdc:.editorconfig)

- 実装ルール（AI/Editor 共通）
  - 新規ファイル/編集は LF のみで保存する（`\r` を含めない）。
  - 既存ファイルのインデントスタイル（タブ/スペース、幅）を保持し、混在させない。
  - 既存の行末形式を変えない（必要な場合はリポジトリ単位で正規化する）。

- 変更後チェック（必要に応じて実行）
  - 追跡済みファイルの正規化:
    ```bash
    git add --renormalize .
    git commit -m "chore: renormalize line endings to LF"
    ```
  - CRLF 混入検知（コミット前に失敗させる pre-commit を推奨）:
    - `.githooks/pre-commit` を導入し、`git config core.hooksPath .githooks` を設定。
    - CRLF が検出されたらコミットを中断し、LF に変換して再ステージ。

- 迅速な一括変換（必要時のみ）
  ```bash
  find . -type f -not -path "./.git/*" -print0 | xargs -0 dos2unix
  ```

- 注意事項
  - Windows/MSYS2 環境でも LF 固定。`git config --global core.autocrlf false` を推奨。
  - ツールチェイン（PlatformIO 等）で CRLF が混入するとビルド/リンク不具合の原因になるため厳守。

